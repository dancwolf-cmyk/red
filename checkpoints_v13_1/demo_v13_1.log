2025-12-05 18:00:17,318 [INFO] => SDPA Flash-Attention enabled (torch 2.7.1+cu118)
2025-12-05 18:00:17,514 [INFO] => loaded cached samples from checkpoints_v13_1\demo_v13_1_samples_mixed.json (n=160000)
2025-12-05 18:00:18,882 [INFO] => [train (labels 2-99)] label balanced to 122892 samples (per-label=1254)
2025-12-05 18:00:18,965 [INFO] => [val (labels 2-99)] label balanced to 13426 samples (per-label=137)
2025-12-05 18:00:25,282 [INFO] => cached split to checkpoints_v13_1\demo_v13_1_train_balanced.json (n=122892)
2025-12-05 18:00:25,953 [INFO] => cached split to checkpoints_v13_1\demo_v13_1_val_balanced.json (n=13426)
2025-12-05 18:00:26,775 [INFO] => cached split to checkpoints_v13_1\demo_v13_1_test_balanced.json (n=15998)
2025-12-05 18:00:26,775 [INFO] => train_size=122892 val_size=13426 test_size=15998
2025-12-05 18:01:13,731 [INFO] => SDPA Flash-Attention enabled (torch 2.7.1+cu118)
2025-12-05 18:01:13,871 [INFO] => loaded cached samples from checkpoints_v13_1\demo_v13_1_samples_mixed.json (n=160000)
2025-12-05 18:01:14,041 [INFO] => loaded balanced train/val/test splits from cache
2025-12-05 18:01:14,042 [INFO] => using cached balanced splits for train/val/test
2025-12-05 18:01:14,042 [INFO] => train_size=122892 val_size=13426 test_size=15998
2025-12-05 18:01:14,763 [INFO] => [base subset (labels 2-99)] label-balanced subset size=12289 (target per-labelâ‰ˆ125)
2025-12-05 18:01:14,957 [INFO] => [expert_train[0]-range_2_20] label balanced to 23826 samples (per-label=1254)
2025-12-05 18:01:14,968 [INFO] => [expert_val[0]-range_2_20] label balanced to 2603 samples (per-label=137)
2025-12-05 18:01:14,981 [INFO] => [expert_test[0]-range_2_20] label balanced to 2641 samples (per-label=139)
2025-12-05 18:01:15,099 [INFO] => [expert_train[1]-range_21_40] label balanced to 25080 samples (per-label=1254)
2025-12-05 18:01:15,111 [INFO] => [expert_val[1]-range_21_40] label balanced to 2740 samples (per-label=137)
2025-12-05 18:01:15,126 [INFO] => [expert_test[1]-range_21_40] label balanced to 2640 samples (per-label=132)
2025-12-05 18:01:15,253 [INFO] => [expert_train[2]-range_41_60] label balanced to 25080 samples (per-label=1254)
2025-12-05 18:01:15,266 [INFO] => [expert_val[2]-range_41_60] label balanced to 2740 samples (per-label=137)
2025-12-05 18:01:15,284 [INFO] => [expert_test[2]-range_41_60] label balanced to 2660 samples (per-label=133)
2025-12-05 18:01:15,408 [INFO] => [expert_train[3]-range_61_80] label balanced to 25080 samples (per-label=1254)
2025-12-05 18:01:15,420 [INFO] => [expert_val[3]-range_61_80] label balanced to 2740 samples (per-label=137)
2025-12-05 18:01:15,434 [INFO] => [expert_test[3]-range_61_80] label balanced to 2680 samples (per-label=134)
2025-12-05 18:01:15,541 [INFO] => [expert_train[4]-range_81_100] label balanced to 23826 samples (per-label=1254)
2025-12-05 18:01:15,552 [INFO] => [expert_val[4]-range_81_100] label balanced to 2603 samples (per-label=137)
2025-12-05 18:01:15,566 [INFO] => [expert_test[4]-range_81_100] label balanced to 2508 samples (per-label=132)
2025-12-05 18:04:24,264 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=4.4935 acc=0.0212 macro_f1=0.0056 n=13426
2025-12-05 18:04:24,265 [INFO] => Base epoch 1 train_loss=4.7008 train_acc=0.0156 val_loss=4.4935 val_acc=0.0212 val_f1=0.0056
2025-12-05 18:04:24,414 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep1.pt
2025-12-05 18:07:42,449 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=4.1349 acc=0.0314 macro_f1=0.0123 n=13426
2025-12-05 18:07:42,451 [INFO] => Base epoch 1 train_loss=4.2885 train_acc=0.0258 val_loss=4.1349 val_acc=0.0314 val_f1=0.0123
2025-12-05 18:07:42,582 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep2.pt
2025-12-05 18:11:10,076 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=4.0050 acc=0.0388 macro_f1=0.0156 n=13426
2025-12-05 18:11:10,077 [INFO] => Base epoch 1 train_loss=4.0532 train_acc=0.0356 val_loss=4.0050 val_acc=0.0388 val_f1=0.0156
2025-12-05 18:11:10,235 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep3.pt
2025-12-05 18:14:42,237 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.7858 acc=0.0565 macro_f1=0.0294 n=13426
2025-12-05 18:14:42,239 [INFO] => Base epoch 1 train_loss=3.8429 train_acc=0.0523 val_loss=3.7858 val_acc=0.0565 val_f1=0.0294
2025-12-05 18:14:42,374 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep4.pt
2025-12-05 18:18:13,594 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.6647 acc=0.0577 macro_f1=0.0309 n=13426
2025-12-05 18:18:13,595 [INFO] => Base epoch 1 train_loss=3.6589 train_acc=0.0688 val_loss=3.6647 val_acc=0.0577 val_f1=0.0309
2025-12-05 18:18:13,722 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep5.pt
2025-12-05 18:21:43,815 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.5870 acc=0.0665 macro_f1=0.0402 n=13426
2025-12-05 18:21:43,817 [INFO] => Base epoch 1 train_loss=3.5711 train_acc=0.0772 val_loss=3.5870 val_acc=0.0665 val_f1=0.0402
2025-12-05 18:21:43,941 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep6.pt
2025-12-05 18:25:15,061 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.4716 acc=0.0780 macro_f1=0.0547 n=13426
2025-12-05 18:25:15,062 [INFO] => Base epoch 1 train_loss=3.4564 train_acc=0.0907 val_loss=3.4716 val_acc=0.0780 val_f1=0.0547
2025-12-05 18:25:15,204 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep7.pt
2025-12-05 18:28:42,695 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.4472 acc=0.0806 macro_f1=0.0579 n=13426
2025-12-05 18:28:42,696 [INFO] => Base epoch 1 train_loss=3.2950 train_acc=0.1132 val_loss=3.4472 val_acc=0.0806 val_f1=0.0579
2025-12-05 18:28:42,821 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep8.pt
2025-12-05 18:32:08,216 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.4263 acc=0.0833 macro_f1=0.0651 n=13426
2025-12-05 18:32:08,217 [INFO] => Base epoch 1 train_loss=3.1888 train_acc=0.1313 val_loss=3.4263 val_acc=0.0833 val_f1=0.0651
2025-12-05 18:32:08,339 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep9.pt
2025-12-05 18:35:32,170 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2895 acc=0.0995 macro_f1=0.0785 n=13426
2025-12-05 18:35:32,171 [INFO] => Base epoch 1 train_loss=3.1705 train_acc=0.1413 val_loss=3.2895 val_acc=0.0995 val_f1=0.0785
2025-12-05 18:35:32,296 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep10.pt
2025-12-05 18:38:54,011 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2486 acc=0.1099 macro_f1=0.0941 n=13426
2025-12-05 18:38:54,013 [INFO] => Base epoch 1 train_loss=3.0625 train_acc=0.1595 val_loss=3.2486 val_acc=0.1099 val_f1=0.0941
2025-12-05 18:38:54,133 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep11.pt
2025-12-05 18:42:16,811 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2796 acc=0.1145 macro_f1=0.1023 n=13426
2025-12-05 18:42:16,812 [INFO] => Base epoch 1 train_loss=2.9830 train_acc=0.1777 val_loss=3.2796 val_acc=0.1145 val_f1=0.1023
2025-12-05 18:42:16,937 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep12.pt
2025-12-05 18:45:40,224 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2051 acc=0.1230 macro_f1=0.1113 n=13426
2025-12-05 18:45:40,225 [INFO] => Base epoch 1 train_loss=2.8769 train_acc=0.2070 val_loss=3.2051 val_acc=0.1230 val_f1=0.1113
2025-12-05 18:45:40,350 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep13.pt
2025-12-05 18:49:02,545 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1910 acc=0.1423 macro_f1=0.1299 n=13426
2025-12-05 18:49:02,546 [INFO] => Base epoch 1 train_loss=2.7290 train_acc=0.2389 val_loss=3.1910 val_acc=0.1423 val_f1=0.1299
2025-12-05 18:49:02,673 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep14.pt
2025-12-05 18:52:24,533 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1045 acc=0.1601 macro_f1=0.1514 n=13426
2025-12-05 18:52:24,534 [INFO] => Base epoch 1 train_loss=2.5887 train_acc=0.2679 val_loss=3.1045 val_acc=0.1601 val_f1=0.1514
2025-12-05 18:52:24,656 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep15.pt
2025-12-05 18:55:52,461 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2673 acc=0.1511 macro_f1=0.1482 n=13426
2025-12-05 18:55:52,463 [INFO] => Base epoch 1 train_loss=2.5499 train_acc=0.2875 val_loss=3.2673 val_acc=0.1511 val_f1=0.1482
2025-12-05 18:59:21,350 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2398 acc=0.1596 macro_f1=0.1477 n=13426
2025-12-05 18:59:21,351 [INFO] => Base epoch 1 train_loss=2.3800 train_acc=0.3375 val_loss=3.2398 val_acc=0.1596 val_f1=0.1477
2025-12-05 19:02:52,988 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1761 acc=0.1790 macro_f1=0.1691 n=13426
2025-12-05 19:02:52,989 [INFO] => Base epoch 1 train_loss=2.2605 train_acc=0.3686 val_loss=3.1761 val_acc=0.1790 val_f1=0.1691
2025-12-05 19:02:53,115 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep18.pt
2025-12-05 19:06:26,033 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2331 acc=0.1989 macro_f1=0.1937 n=13426
2025-12-05 19:06:26,034 [INFO] => Base epoch 1 train_loss=2.0234 train_acc=0.4317 val_loss=3.2331 val_acc=0.1989 val_f1=0.1937
2025-12-05 19:06:26,162 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep19.pt
2025-12-05 19:10:02,684 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0103 acc=0.2293 macro_f1=0.2273 n=13426
2025-12-05 19:10:02,686 [INFO] => Base epoch 1 train_loss=1.9866 train_acc=0.4473 val_loss=3.0103 val_acc=0.2293 val_f1=0.2273
2025-12-05 19:10:02,814 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep20.pt
2025-12-05 19:13:39,836 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0057 acc=0.2339 macro_f1=0.2326 n=13426
2025-12-05 19:13:39,838 [INFO] => Base epoch 1 train_loss=1.7726 train_acc=0.5050 val_loss=3.0057 val_acc=0.2339 val_f1=0.2326
2025-12-05 19:13:39,971 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep21.pt
2025-12-05 19:17:17,125 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1053 acc=0.2424 macro_f1=0.2381 n=13426
2025-12-05 19:17:17,125 [INFO] => Base epoch 1 train_loss=1.7093 train_acc=0.5265 val_loss=3.1053 val_acc=0.2424 val_f1=0.2381
2025-12-05 19:17:17,257 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep22.pt
2025-12-05 19:20:53,718 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0127 acc=0.2560 macro_f1=0.2555 n=13426
2025-12-05 19:20:53,720 [INFO] => Base epoch 1 train_loss=1.5289 train_acc=0.5732 val_loss=3.0127 val_acc=0.2560 val_f1=0.2555
2025-12-05 19:20:53,844 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep23.pt
2025-12-05 19:24:30,859 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0479 acc=0.2668 macro_f1=0.2649 n=13426
2025-12-05 19:24:30,860 [INFO] => Base epoch 1 train_loss=1.3970 train_acc=0.6112 val_loss=3.0479 val_acc=0.2668 val_f1=0.2649
2025-12-05 19:24:30,987 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep24.pt
2025-12-05 19:28:06,468 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1162 acc=0.2739 macro_f1=0.2730 n=13426
2025-12-05 19:28:06,469 [INFO] => Base epoch 1 train_loss=1.3452 train_acc=0.6283 val_loss=3.1162 val_acc=0.2739 val_f1=0.2730
2025-12-05 19:28:06,596 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep25.pt
2025-12-05 19:31:39,470 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0499 acc=0.2911 macro_f1=0.2900 n=13426
2025-12-05 19:31:39,473 [INFO] => Base epoch 1 train_loss=1.1817 train_acc=0.6743 val_loss=3.0499 val_acc=0.2911 val_f1=0.2900
2025-12-05 19:31:39,615 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep26.pt
2025-12-05 19:35:29,621 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0305 acc=0.2996 macro_f1=0.2989 n=13426
2025-12-05 19:35:29,622 [INFO] => Base epoch 1 train_loss=1.0684 train_acc=0.7086 val_loss=3.0305 val_acc=0.2996 val_f1=0.2989
2025-12-05 19:35:29,755 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep27.pt
2025-12-05 19:39:40,612 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0701 acc=0.3075 macro_f1=0.3056 n=13426
2025-12-05 19:39:40,614 [INFO] => Base epoch 1 train_loss=0.9640 train_acc=0.7348 val_loss=3.0701 val_acc=0.3075 val_f1=0.3056
2025-12-05 19:39:40,744 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep28.pt
2025-12-05 19:44:01,002 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.0592 acc=0.3158 macro_f1=0.3135 n=13426
2025-12-05 19:44:01,004 [INFO] => Base epoch 1 train_loss=0.8661 train_acc=0.7620 val_loss=3.0592 val_acc=0.3158 val_f1=0.3135
2025-12-05 19:44:01,140 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep29.pt
2025-12-05 19:48:11,882 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1210 acc=0.3192 macro_f1=0.3207 n=13426
2025-12-05 19:48:11,883 [INFO] => Base epoch 1 train_loss=0.7860 train_acc=0.7836 val_loss=3.1210 val_acc=0.3192 val_f1=0.3207
2025-12-05 19:48:12,018 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep30.pt
2025-12-05 19:52:13,882 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2742 acc=0.3198 macro_f1=0.3188 n=13426
2025-12-05 19:52:13,883 [INFO] => Base epoch 1 train_loss=0.7197 train_acc=0.8013 val_loss=3.2742 val_acc=0.3198 val_f1=0.3188
2025-12-05 19:52:14,020 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep31.pt
2025-12-05 19:55:55,070 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.1721 acc=0.3270 macro_f1=0.3263 n=13426
2025-12-05 19:55:55,071 [INFO] => Base epoch 1 train_loss=0.6347 train_acc=0.8273 val_loss=3.1721 val_acc=0.3270 val_f1=0.3263
2025-12-05 19:55:55,217 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep32.pt
2025-12-05 19:59:32,875 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2589 acc=0.3254 macro_f1=0.3252 n=13426
2025-12-05 19:59:32,877 [INFO] => Base epoch 1 train_loss=0.6064 train_acc=0.8317 val_loss=3.2589 val_acc=0.3254 val_f1=0.3252
2025-12-05 20:03:14,648 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2477 acc=0.3365 macro_f1=0.3329 n=13426
2025-12-05 20:03:14,650 [INFO] => Base epoch 1 train_loss=0.5288 train_acc=0.8558 val_loss=3.2477 val_acc=0.3365 val_f1=0.3329
2025-12-05 20:03:14,779 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep34.pt
2025-12-05 20:06:51,642 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.2932 acc=0.3424 macro_f1=0.3402 n=13426
2025-12-05 20:06:51,643 [INFO] => Base epoch 1 train_loss=0.4761 train_acc=0.8700 val_loss=3.2932 val_acc=0.3424 val_f1=0.3402
2025-12-05 20:06:51,772 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep35.pt
2025-12-05 20:10:30,598 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.3652 acc=0.3402 macro_f1=0.3405 n=13426
2025-12-05 20:10:30,600 [INFO] => Base epoch 1 train_loss=0.4010 train_acc=0.8896 val_loss=3.3652 val_acc=0.3402 val_f1=0.3405
2025-12-05 20:14:08,104 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.3815 acc=0.3437 macro_f1=0.3451 n=13426
2025-12-05 20:14:08,106 [INFO] => Base epoch 1 train_loss=0.3797 train_acc=0.8981 val_loss=3.3815 val_acc=0.3437 val_f1=0.3451
2025-12-05 20:14:08,233 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep37.pt
2025-12-05 20:17:48,778 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.4860 acc=0.3453 macro_f1=0.3475 n=13426
2025-12-05 20:17:48,780 [INFO] => Base epoch 1 train_loss=0.3547 train_acc=0.9008 val_loss=3.4860 val_acc=0.3453 val_f1=0.3475
2025-12-05 20:17:48,909 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_base_best_ep38.pt
2025-12-05 20:21:22,912 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.5095 acc=0.3419 macro_f1=0.3423 n=13426
2025-12-05 20:21:22,913 [INFO] => Base epoch 1 train_loss=0.3087 train_acc=0.9164 val_loss=3.5095 val_acc=0.3419 val_f1=0.3423
2025-12-05 20:24:54,783 [INFO] [EvalLoss] [Base-VAL] epoch 1/1 mode=base loss=3.5632 acc=0.3420 macro_f1=0.3398 n=13426
2025-12-05 20:24:54,784 [INFO] => Base epoch 1 train_loss=0.2519 train_acc=0.9315 val_loss=3.5632 val_acc=0.3420 val_f1=0.3398
2025-12-05 20:24:54,887 [INFO] => loaded best checkpoint for base: checkpoints_v13_1\demo_v13_1_base_best_ep38.pt (missing=299 unexpected=0)
2025-12-05 20:24:54,887 [INFO] Starting evaluation (mode=base)
2025-12-05 20:43:51,586 [INFO] [Eval] Base All mode=base acc=0.3862 macro_f1=0.3912 n=160000
2025-12-05 20:43:51,606 [INFO] === Per-range evaluation: Base All per-range (mode=base) ===
2025-12-05 20:47:29,696 [INFO] Range 2-20: acc=0.4849 macro_f1=0.1010 (n=30707)
2025-12-05 20:51:16,043 [INFO] Range 21-40: acc=0.4286 macro_f1=0.0972 (n=32326)
2025-12-05 20:55:01,831 [INFO] Range 41-60: acc=0.3864 macro_f1=0.0885 (n=32323)
2025-12-05 20:58:58,051 [INFO] Range 61-80: acc=0.3321 macro_f1=0.0787 (n=32323)
2025-12-05 21:02:46,875 [INFO] Range 81-100: acc=0.3041 macro_f1=0.0645 (n=32321)
2025-12-05 21:05:56,646 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.7228 acc=0.5555 n=2603
2025-12-05 21:05:56,647 [INFO] => Expert 0 epoch 1 train_loss=1.8128 train_acc=0.5622 val_loss=1.7228 val_acc=0.5555
2025-12-05 21:05:56,678 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep1.pt
2025-12-05 21:09:04,582 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.5462 acc=0.5851 n=2603
2025-12-05 21:09:04,583 [INFO] => Expert 0 epoch 1 train_loss=1.4161 train_acc=0.6148 val_loss=1.5462 val_acc=0.5851
2025-12-05 21:09:04,618 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep2.pt
2025-12-05 21:12:14,062 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.4856 acc=0.5916 n=2603
2025-12-05 21:12:14,062 [INFO] => Expert 0 epoch 1 train_loss=1.1751 train_acc=0.6569 val_loss=1.4856 val_acc=0.5916
2025-12-05 21:12:14,102 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep3.pt
2025-12-05 21:15:22,458 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.4321 acc=0.5966 n=2603
2025-12-05 21:15:22,459 [INFO] => Expert 0 epoch 1 train_loss=0.9791 train_acc=0.6969 val_loss=1.4321 val_acc=0.5966
2025-12-05 21:15:22,488 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep4.pt
2025-12-05 21:18:31,379 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.4642 acc=0.6062 n=2603
2025-12-05 21:18:31,379 [INFO] => Expert 0 epoch 1 train_loss=0.7888 train_acc=0.7502 val_loss=1.4642 val_acc=0.6062
2025-12-05 21:18:31,421 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep5.pt
2025-12-05 21:21:41,852 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.4740 acc=0.6028 n=2603
2025-12-05 21:21:41,852 [INFO] => Expert 0 epoch 1 train_loss=0.6157 train_acc=0.8060 val_loss=1.4740 val_acc=0.6028
2025-12-05 21:24:49,895 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.5224 acc=0.6093 n=2603
2025-12-05 21:24:49,896 [INFO] => Expert 0 epoch 1 train_loss=0.4625 train_acc=0.8559 val_loss=1.5224 val_acc=0.6093
2025-12-05 21:24:49,926 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep7.pt
2025-12-05 21:27:57,612 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.5949 acc=0.6112 n=2603
2025-12-05 21:27:57,612 [INFO] => Expert 0 epoch 1 train_loss=0.3331 train_acc=0.9015 val_loss=1.5949 val_acc=0.6112
2025-12-05 21:27:57,644 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep8.pt
2025-12-05 21:31:06,807 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.6486 acc=0.6201 n=2603
2025-12-05 21:31:06,807 [INFO] => Expert 0 epoch 1 train_loss=0.2377 train_acc=0.9349 val_loss=1.6486 val_acc=0.6201
2025-12-05 21:31:06,841 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_0_best_ep9.pt
2025-12-05 21:35:04,884 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.7864 acc=0.6104 n=2603
2025-12-05 21:35:04,884 [INFO] => Expert 0 epoch 1 train_loss=0.1711 train_acc=0.9552 val_loss=1.7864 val_acc=0.6104
2025-12-05 21:38:49,025 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.8313 acc=0.6135 n=2603
2025-12-05 21:38:49,025 [INFO] => Expert 0 epoch 1 train_loss=0.1313 train_acc=0.9663 val_loss=1.8313 val_acc=0.6135
2025-12-05 21:42:01,687 [INFO] [Expert 0 Eval] [Expert 0 VAL] epoch 1/1 loss=1.9056 acc=0.6193 n=2603
2025-12-05 21:42:01,687 [INFO] => Expert 0 epoch 1 train_loss=0.0989 train_acc=0.9752 val_loss=1.9056 val_acc=0.6193
2025-12-05 21:42:01,688 [INFO] => Early stopping expert_0 at epoch 12 by val_acc (patience=3)
2025-12-05 21:42:01,724 [INFO] => loaded best checkpoint for expert_0: checkpoints_v13_1\demo_v13_1_expert_0_best_ep9.pt (missing=332 unexpected=0)
2025-12-05 21:45:24,033 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.7899 acc=0.5544 n=2740
2025-12-05 21:45:24,034 [INFO] => Expert 1 epoch 1 train_loss=1.9737 train_acc=0.5317 val_loss=1.7899 val_acc=0.5544
2025-12-05 21:45:24,061 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep1.pt
2025-12-05 21:48:42,763 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.6489 acc=0.5799 n=2740
2025-12-05 21:48:42,764 [INFO] => Expert 1 epoch 1 train_loss=1.5093 train_acc=0.6055 val_loss=1.6489 val_acc=0.5799
2025-12-05 21:48:42,795 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep2.pt
2025-12-05 21:52:00,746 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.5773 acc=0.5956 n=2740
2025-12-05 21:52:00,746 [INFO] => Expert 1 epoch 1 train_loss=1.2341 train_acc=0.6536 val_loss=1.5773 val_acc=0.5956
2025-12-05 21:52:00,778 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep3.pt
2025-12-05 21:55:17,977 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.5643 acc=0.5945 n=2740
2025-12-05 21:55:17,977 [INFO] => Expert 1 epoch 1 train_loss=1.0052 train_acc=0.7023 val_loss=1.5643 val_acc=0.5945
2025-12-05 21:58:34,665 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.5969 acc=0.5974 n=2740
2025-12-05 21:58:34,665 [INFO] => Expert 1 epoch 1 train_loss=0.7880 train_acc=0.7548 val_loss=1.5969 val_acc=0.5974
2025-12-05 21:58:34,698 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep5.pt
2025-12-05 22:01:53,284 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.6583 acc=0.6011 n=2740
2025-12-05 22:01:53,284 [INFO] => Expert 1 epoch 1 train_loss=0.5907 train_acc=0.8210 val_loss=1.6583 val_acc=0.6011
2025-12-05 22:01:53,315 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep6.pt
2025-12-05 22:05:12,794 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.7394 acc=0.5964 n=2740
2025-12-05 22:05:12,794 [INFO] => Expert 1 epoch 1 train_loss=0.4228 train_acc=0.8760 val_loss=1.7394 val_acc=0.5964
2025-12-05 22:08:31,899 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.7799 acc=0.6080 n=2740
2025-12-05 22:08:31,899 [INFO] => Expert 1 epoch 1 train_loss=0.2914 train_acc=0.9187 val_loss=1.7799 val_acc=0.6080
2025-12-05 22:08:31,933 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep8.pt
2025-12-05 22:11:51,153 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.8824 acc=0.6084 n=2740
2025-12-05 22:11:51,153 [INFO] => Expert 1 epoch 1 train_loss=0.1998 train_acc=0.9486 val_loss=1.8824 val_acc=0.6084
2025-12-05 22:11:51,184 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_1_best_ep9.pt
2025-12-05 22:15:09,914 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=1.9766 acc=0.6080 n=2740
2025-12-05 22:15:09,914 [INFO] => Expert 1 epoch 1 train_loss=0.1387 train_acc=0.9673 val_loss=1.9766 val_acc=0.6080
2025-12-05 22:18:28,792 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=2.1032 acc=0.6036 n=2740
2025-12-05 22:18:28,792 [INFO] => Expert 1 epoch 1 train_loss=0.1075 train_acc=0.9746 val_loss=2.1032 val_acc=0.6036
2025-12-05 22:21:48,459 [INFO] [Expert 1 Eval] [Expert 1 VAL] epoch 1/1 loss=2.2020 acc=0.6066 n=2740
2025-12-05 22:21:48,460 [INFO] => Expert 1 epoch 1 train_loss=0.0852 train_acc=0.9792 val_loss=2.2020 val_acc=0.6066
2025-12-05 22:21:48,460 [INFO] => Early stopping expert_1 at epoch 12 by val_acc (patience=3)
2025-12-05 22:21:48,495 [INFO] => loaded best checkpoint for expert_1: checkpoints_v13_1\demo_v13_1_expert_1_best_ep9.pt (missing=332 unexpected=0)
2025-12-05 22:25:07,165 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.9462 acc=0.5153 n=2740
2025-12-05 22:25:07,165 [INFO] => Expert 2 epoch 1 train_loss=2.1170 train_acc=0.4972 val_loss=1.9462 val_acc=0.5153
2025-12-05 22:25:07,195 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep1.pt
2025-12-05 22:28:26,314 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.7406 acc=0.5569 n=2740
2025-12-05 22:28:26,314 [INFO] => Expert 2 epoch 1 train_loss=1.6002 train_acc=0.5857 val_loss=1.7406 val_acc=0.5569
2025-12-05 22:28:26,347 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep2.pt
2025-12-05 22:31:47,283 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.6982 acc=0.5591 n=2740
2025-12-05 22:31:47,283 [INFO] => Expert 2 epoch 1 train_loss=1.3066 train_acc=0.6372 val_loss=1.6982 val_acc=0.5591
2025-12-05 22:31:47,314 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep3.pt
2025-12-05 22:35:08,476 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.6843 acc=0.5624 n=2740
2025-12-05 22:35:08,476 [INFO] => Expert 2 epoch 1 train_loss=1.0578 train_acc=0.6864 val_loss=1.6843 val_acc=0.5624
2025-12-05 22:35:08,509 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep4.pt
2025-12-05 22:38:28,115 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.7267 acc=0.5657 n=2740
2025-12-05 22:38:28,115 [INFO] => Expert 2 epoch 1 train_loss=0.8380 train_acc=0.7464 val_loss=1.7267 val_acc=0.5657
2025-12-05 22:38:28,146 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep5.pt
2025-12-05 22:41:48,648 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.7334 acc=0.5712 n=2740
2025-12-05 22:41:48,649 [INFO] => Expert 2 epoch 1 train_loss=0.6355 train_acc=0.8084 val_loss=1.7334 val_acc=0.5712
2025-12-05 22:41:48,689 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep6.pt
2025-12-05 22:45:14,110 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.8062 acc=0.5693 n=2740
2025-12-05 22:45:14,111 [INFO] => Expert 2 epoch 1 train_loss=0.4569 train_acc=0.8654 val_loss=1.8062 val_acc=0.5693
2025-12-05 22:48:33,400 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=1.9003 acc=0.5712 n=2740
2025-12-05 22:48:33,401 [INFO] => Expert 2 epoch 1 train_loss=0.3125 train_acc=0.9159 val_loss=1.9003 val_acc=0.5712
2025-12-05 22:51:52,354 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=2.0098 acc=0.5741 n=2740
2025-12-05 22:51:52,355 [INFO] => Expert 2 epoch 1 train_loss=0.2185 train_acc=0.9440 val_loss=2.0098 val_acc=0.5741
2025-12-05 22:51:52,385 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_2_best_ep9.pt
2025-12-05 22:55:12,071 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=2.1272 acc=0.5719 n=2740
2025-12-05 22:55:12,072 [INFO] => Expert 2 epoch 1 train_loss=0.1576 train_acc=0.9618 val_loss=2.1272 val_acc=0.5719
2025-12-05 22:58:30,839 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=2.2107 acc=0.5668 n=2740
2025-12-05 22:58:30,839 [INFO] => Expert 2 epoch 1 train_loss=0.1190 train_acc=0.9729 val_loss=2.2107 val_acc=0.5668
2025-12-05 23:01:56,757 [INFO] [Expert 2 Eval] [Expert 2 VAL] epoch 1/1 loss=2.3197 acc=0.5730 n=2740
2025-12-05 23:01:56,757 [INFO] => Expert 2 epoch 1 train_loss=0.0994 train_acc=0.9748 val_loss=2.3197 val_acc=0.5730
2025-12-05 23:01:56,757 [INFO] => Early stopping expert_2 at epoch 12 by val_acc (patience=3)
2025-12-05 23:01:56,803 [INFO] => loaded best checkpoint for expert_2: checkpoints_v13_1\demo_v13_1_expert_2_best_ep9.pt (missing=332 unexpected=0)
2025-12-05 23:05:21,794 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=2.1625 acc=0.4734 n=2740
2025-12-05 23:05:21,795 [INFO] => Expert 3 epoch 1 train_loss=2.3237 train_acc=0.4586 val_loss=2.1625 val_acc=0.4734
2025-12-05 23:05:21,825 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep1.pt
2025-12-05 23:08:41,001 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.9021 acc=0.5325 n=2740
2025-12-05 23:08:41,001 [INFO] => Expert 3 epoch 1 train_loss=1.7260 train_acc=0.5622 val_loss=1.9021 val_acc=0.5325
2025-12-05 23:08:41,034 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep2.pt
2025-12-05 23:11:56,697 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.8103 acc=0.5511 n=2740
2025-12-05 23:11:56,697 [INFO] => Expert 3 epoch 1 train_loss=1.4224 train_acc=0.6176 val_loss=1.8103 val_acc=0.5511
2025-12-05 23:11:56,726 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep3.pt
2025-12-05 23:15:11,670 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.7867 acc=0.5569 n=2740
2025-12-05 23:15:11,671 [INFO] => Expert 3 epoch 1 train_loss=1.1598 train_acc=0.6674 val_loss=1.7867 val_acc=0.5569
2025-12-05 23:15:11,719 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep4.pt
2025-12-05 23:18:26,658 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.7739 acc=0.5609 n=2740
2025-12-05 23:18:26,658 [INFO] => Expert 3 epoch 1 train_loss=0.9289 train_acc=0.7251 val_loss=1.7739 val_acc=0.5609
2025-12-05 23:18:26,689 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep5.pt
2025-12-05 23:21:43,422 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.8349 acc=0.5617 n=2740
2025-12-05 23:21:43,422 [INFO] => Expert 3 epoch 1 train_loss=0.7178 train_acc=0.7838 val_loss=1.8349 val_acc=0.5617
2025-12-05 23:21:43,455 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep6.pt
2025-12-05 23:24:59,893 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.8774 acc=0.5719 n=2740
2025-12-05 23:24:59,893 [INFO] => Expert 3 epoch 1 train_loss=0.5304 train_acc=0.8418 val_loss=1.8774 val_acc=0.5719
2025-12-05 23:24:59,925 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep7.pt
2025-12-05 23:28:17,216 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=1.9572 acc=0.5741 n=2740
2025-12-05 23:28:17,217 [INFO] => Expert 3 epoch 1 train_loss=0.3770 train_acc=0.8919 val_loss=1.9572 val_acc=0.5741
2025-12-05 23:28:17,248 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_3_best_ep8.pt
2025-12-05 23:31:33,898 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=2.1016 acc=0.5631 n=2740
2025-12-05 23:31:33,898 [INFO] => Expert 3 epoch 1 train_loss=0.2635 train_acc=0.9277 val_loss=2.1016 val_acc=0.5631
2025-12-05 23:34:49,962 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=2.2073 acc=0.5664 n=2740
2025-12-05 23:34:49,962 [INFO] => Expert 3 epoch 1 train_loss=0.1892 train_acc=0.9518 val_loss=2.2073 val_acc=0.5664
2025-12-05 23:38:05,407 [INFO] [Expert 3 Eval] [Expert 3 VAL] epoch 1/1 loss=2.3201 acc=0.5701 n=2740
2025-12-05 23:38:05,407 [INFO] => Expert 3 epoch 1 train_loss=0.1388 train_acc=0.9658 val_loss=2.3201 val_acc=0.5701
2025-12-05 23:38:05,407 [INFO] => Early stopping expert_3 at epoch 11 by val_acc (patience=3)
2025-12-05 23:38:05,439 [INFO] => loaded best checkpoint for expert_3: checkpoints_v13_1\demo_v13_1_expert_3_best_ep8.pt (missing=332 unexpected=0)
2025-12-05 23:41:11,802 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.1869 acc=0.4441 n=2603
2025-12-05 23:41:11,803 [INFO] => Expert 4 epoch 1 train_loss=2.3711 train_acc=0.4355 val_loss=2.1869 val_acc=0.4441
2025-12-05 23:41:11,833 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep1.pt
2025-12-05 23:44:19,050 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.9566 acc=0.5025 n=2603
2025-12-05 23:44:19,050 [INFO] => Expert 4 epoch 1 train_loss=1.7784 train_acc=0.5394 val_loss=1.9566 val_acc=0.5025
2025-12-05 23:44:19,081 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep2.pt
2025-12-05 23:47:28,044 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.8638 acc=0.5282 n=2603
2025-12-05 23:47:28,045 [INFO] => Expert 4 epoch 1 train_loss=1.4511 train_acc=0.6070 val_loss=1.8638 val_acc=0.5282
2025-12-05 23:47:28,077 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep3.pt
2025-12-05 23:50:35,019 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.8438 acc=0.5482 n=2603
2025-12-05 23:50:35,020 [INFO] => Expert 4 epoch 1 train_loss=1.1987 train_acc=0.6550 val_loss=1.8438 val_acc=0.5482
2025-12-05 23:50:35,052 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep4.pt
2025-12-05 23:53:41,663 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.8245 acc=0.5547 n=2603
2025-12-05 23:53:41,663 [INFO] => Expert 4 epoch 1 train_loss=0.9583 train_acc=0.7160 val_loss=1.8245 val_acc=0.5547
2025-12-05 23:53:41,696 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep5.pt
2025-12-05 23:56:48,561 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.9266 acc=0.5574 n=2603
2025-12-05 23:56:48,562 [INFO] => Expert 4 epoch 1 train_loss=0.7520 train_acc=0.7758 val_loss=1.9266 val_acc=0.5574
2025-12-05 23:56:48,591 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep6.pt
2025-12-05 23:59:55,183 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=1.9561 acc=0.5532 n=2603
2025-12-05 23:59:55,184 [INFO] => Expert 4 epoch 1 train_loss=0.5618 train_acc=0.8334 val_loss=1.9561 val_acc=0.5532
2025-12-06 00:03:02,739 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.0240 acc=0.5609 n=2603
2025-12-06 00:03:02,740 [INFO] => Expert 4 epoch 1 train_loss=0.4009 train_acc=0.8854 val_loss=2.0240 val_acc=0.5609
2025-12-06 00:03:02,772 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep8.pt
2025-12-06 00:06:09,403 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.1214 acc=0.5640 n=2603
2025-12-06 00:06:09,403 [INFO] => Expert 4 epoch 1 train_loss=0.2827 train_acc=0.9250 val_loss=2.1214 val_acc=0.5640
2025-12-06 00:06:09,433 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_expert_4_best_ep9.pt
2025-12-06 00:09:15,325 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.2271 acc=0.5578 n=2603
2025-12-06 00:09:15,325 [INFO] => Expert 4 epoch 1 train_loss=0.2040 train_acc=0.9492 val_loss=2.2271 val_acc=0.5578
2025-12-06 00:12:21,974 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.3929 acc=0.5559 n=2603
2025-12-06 00:12:21,975 [INFO] => Expert 4 epoch 1 train_loss=0.1508 train_acc=0.9631 val_loss=2.3929 val_acc=0.5559
2025-12-06 00:15:30,189 [INFO] [Expert 4 Eval] [Expert 4 VAL] epoch 1/1 loss=2.5039 acc=0.5567 n=2603
2025-12-06 00:15:30,189 [INFO] => Expert 4 epoch 1 train_loss=0.1182 train_acc=0.9717 val_loss=2.5039 val_acc=0.5567
2025-12-06 00:15:30,189 [INFO] => Early stopping expert_4 at epoch 12 by val_acc (patience=3)
2025-12-06 00:15:30,231 [INFO] => loaded best checkpoint for expert_4: checkpoints_v13_1\demo_v13_1_expert_4_best_ep9.pt (missing=332 unexpected=0)
2025-12-06 00:15:30,232 [INFO] Starting evaluation (mode=all_fixed)
2025-12-06 00:29:44,415 [INFO] [Eval] AllExperts Train mode=all_fixed acc=0.1627 macro_f1=0.1432 n=122892
2025-12-06 00:31:17,739 [INFO] [Eval] AllExperts Val mode=all_fixed acc=0.1119 macro_f1=0.0982 n=13426
2025-12-06 00:33:08,340 [INFO] [Eval] AllExperts Test mode=all_fixed acc=0.1154 macro_f1=0.1006 n=15998
2025-12-06 00:51:35,352 [INFO] [Eval] AllExperts All mode=all_fixed acc=0.1552 macro_f1=0.1340 n=160000
2025-12-06 00:51:35,371 [INFO] === Per-range evaluation: AllExperts All per-range (mode=all_fixed) ===
2025-12-06 00:51:53,706 [INFO] Range 2-20: acc=0.3112 macro_f1=0.0649 (n=2641)
2025-12-06 00:52:12,069 [INFO] Range 21-40: acc=0.0856 macro_f1=0.0272 (n=2640)
2025-12-06 00:52:30,620 [INFO] Range 41-60: acc=0.0440 macro_f1=0.0145 (n=2660)
2025-12-06 00:52:49,271 [INFO] Range 61-80: acc=0.0780 macro_f1=0.0240 (n=2680)
2025-12-06 00:53:06,874 [INFO] Range 81-100: acc=0.0586 macro_f1=0.0169 (n=2508)
2025-12-06 00:53:06,874 [INFO] Starting single expert[0] evaluation (base + expert_0 checkpoints only)
2025-12-06 00:53:08,778 [INFO] => loaded best checkpoint for base: checkpoints_v13_1\demo_v13_1_base_best_ep38.pt (missing=299 unexpected=0)
2025-12-06 00:53:08,806 [INFO] => loaded best checkpoint for expert_0: checkpoints_v13_1\demo_v13_1_expert_0_best_ep9.pt (missing=332 unexpected=0)
2025-12-06 00:53:26,861 [INFO] [Expert 0 Eval] Expert0 Val (range_2_20) loss=1.6486 acc=0.6201 n=2603
2025-12-06 00:53:45,181 [INFO] [Expert 0 Eval] Expert0 Test (range_2_20) loss=1.7117 acc=0.6028 n=2641
2025-12-06 01:07:51,877 [INFO] => Router epoch 1 avg_loss=0.6672 avg_acc=0.7401
2025-12-06 01:09:23,519 [INFO] [RouterEval] [Router VAL] epoch 1/8 loss=0.5692 acc=0.7734 n=13426
2025-12-06 01:09:23,530 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_router_best_ep1.pt
2025-12-06 01:23:34,216 [INFO] => Router epoch 1 avg_loss=0.5800 avg_acc=0.7709
2025-12-06 01:25:06,325 [INFO] [RouterEval] [Router VAL] epoch 2/8 loss=0.5665 acc=0.7786 n=13426
2025-12-06 01:25:06,337 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_router_best_ep2.pt
2025-12-06 01:39:13,274 [INFO] => Router epoch 1 avg_loss=0.5743 avg_acc=0.7743
2025-12-06 01:40:45,058 [INFO] [RouterEval] [Router VAL] epoch 3/8 loss=0.5596 acc=0.7766 n=13426
2025-12-06 01:54:51,265 [INFO] => Router epoch 1 avg_loss=0.5754 avg_acc=0.7741
2025-12-06 01:56:22,983 [INFO] [RouterEval] [Router VAL] epoch 4/8 loss=0.5633 acc=0.7789 n=13426
2025-12-06 01:56:22,997 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_router_best_ep4.pt
2025-12-06 02:12:07,454 [INFO] => Router epoch 1 avg_loss=0.5760 avg_acc=0.7770
2025-12-06 02:13:39,433 [INFO] [RouterEval] [Router VAL] epoch 5/8 loss=0.5410 acc=0.7908 n=13426
2025-12-06 02:13:39,446 [INFO] => checkpoint saved: checkpoints_v13_1\demo_v13_1_router_best_ep5.pt
2025-12-06 02:27:51,344 [INFO] => Router epoch 1 avg_loss=0.5774 avg_acc=0.7739
2025-12-06 02:29:24,419 [INFO] [RouterEval] [Router VAL] epoch 6/8 loss=0.6025 acc=0.7707 n=13426
2025-12-06 02:43:38,514 [INFO] => Router epoch 1 avg_loss=0.5736 avg_acc=0.7746
2025-12-06 02:45:12,522 [INFO] [RouterEval] [Router VAL] epoch 7/8 loss=0.5546 acc=0.7844 n=13426
2025-12-06 02:59:25,838 [INFO] => Router epoch 1 avg_loss=0.5741 avg_acc=0.7747
2025-12-06 03:00:58,763 [INFO] [RouterEval] [Router VAL] epoch 8/8 loss=0.5615 acc=0.7820 n=13426
2025-12-06 03:00:58,764 [INFO] => Early stopping router at epoch 8 by val_acc (patience=3)
2025-12-06 03:00:58,794 [INFO] => loaded best checkpoint for router: checkpoints_v13_1\demo_v13_1_router_best_ep5.pt (missing=334 unexpected=0)
2025-12-06 03:00:58,794 [INFO] Starting evaluation (mode=router)
2025-12-06 03:15:25,254 [INFO] [Eval] Router Train mode=router acc=0.7847 macro_f1=0.7778 n=122892
2025-12-06 03:17:00,361 [INFO] [Eval] Router Val mode=router acc=0.5287 macro_f1=0.5251 n=13426
2025-12-06 03:18:53,201 [INFO] [Eval] Router Test mode=router acc=0.5163 macro_f1=0.5149 n=15998
2025-12-06 03:38:22,440 [INFO] [Eval] Router All mode=router acc=0.7193 macro_f1=0.7168 n=160000
2025-12-06 03:38:22,456 [INFO] === Per-range evaluation: Router All per-range (mode=router) ===
2025-12-06 03:38:41,474 [INFO] Range 2-20: acc=0.5748 macro_f1=0.1181 (n=2641)
2025-12-06 03:38:59,888 [INFO] Range 21-40: acc=0.5322 macro_f1=0.1178 (n=2640)
2025-12-06 03:39:18,751 [INFO] Range 41-60: acc=0.5086 macro_f1=0.1168 (n=2660)
2025-12-06 03:39:37,596 [INFO] Range 61-80: acc=0.5078 macro_f1=0.1142 (n=2680)
2025-12-06 03:39:55,148 [INFO] Range 81-100: acc=0.4773 macro_f1=0.1034 (n=2508)
2025-12-06 03:39:56,544 [INFO] => loaded best checkpoint for base: checkpoints_v13_1\demo_v13_1_base_best_ep38.pt (missing=299 unexpected=1)
2025-12-06 03:39:56,592 [INFO] => loaded best checkpoint for expert_0: checkpoints_v13_1\demo_v13_1_expert_0_best_ep9.pt (missing=332 unexpected=1)
2025-12-06 03:39:56,637 [INFO] => loaded best checkpoint for expert_1: checkpoints_v13_1\demo_v13_1_expert_1_best_ep9.pt (missing=332 unexpected=1)
2025-12-06 03:39:56,683 [INFO] => loaded best checkpoint for expert_2: checkpoints_v13_1\demo_v13_1_expert_2_best_ep9.pt (missing=332 unexpected=1)
2025-12-06 03:39:56,727 [INFO] => loaded best checkpoint for expert_3: checkpoints_v13_1\demo_v13_1_expert_3_best_ep8.pt (missing=332 unexpected=1)
2025-12-06 03:39:56,770 [INFO] => loaded best checkpoint for expert_4: checkpoints_v13_1\demo_v13_1_expert_4_best_ep9.pt (missing=332 unexpected=1)
2025-12-06 05:40:50,220 [INFO] => MoE epoch 1 avg_loss=54.1614 avg_acc=0.2805
2025-12-06 05:40:51,610 [INFO] => new best MoE checkpoint: checkpoints_v13_1\demo_v13_1_moe_best_ep1.pt (loss=54.1614)
2025-12-06 07:41:29,174 [INFO] => MoE epoch 2 avg_loss=47.8457 avg_acc=0.3162
2025-12-06 07:41:30,721 [INFO] => new best MoE checkpoint: checkpoints_v13_1\demo_v13_1_moe_best_ep2.pt (loss=47.8457)
